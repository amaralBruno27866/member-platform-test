# Email Verification URLs Documentation

This document contains the exact URLs that the backend team needs to use in their email templates with action buttons.

**Frontend Base URL:** `https://osot.ca` (production) or `http://localhost:5173` (development)

---

## 1. Professional User Email Verification

**Email Template:** Professional User Verification Email

**Button URL Format:**
```
{FRONTEND_URL}/verify-email?sessionId={sessionId}&token={verificationToken}
```

**Example:**
```
https://osot.ca/verify-email?sessionId=reg_1a2b3c4d_5e6f7g8h&token=verify_abc123xyz789
```

**Parameters:**
- `sessionId`: Registration session ID from orchestrator
- `token`: Email verification token generated by backend

**Backend Endpoint:** `POST /api/public/orchestrator/verify-email`

---

## 2. Affiliate Organization Email Verification

**Email Template:** Affiliate Organization Verification Email

**Button URL Format:**
```
{FRONTEND_URL}/verify-affiliate-email?sessionId={sessionId}&token={verificationToken}
```

**Example:**
```
https://osot.ca/verify-affiliate-email?sessionId=aff_9z8y7x6w_5v4u3t&token=verify_def456uvw012
```

**Parameters:**
- `sessionId`: Registration session ID from affiliates
- `token`: Email verification token generated by backend

**Backend Endpoint:** `POST /api/public/affiliates/verify-email`

---

## 3. Admin Approval - Professional Account

**Email Template:** Admin Approval Notification Email (Professional)

**Approve Button URL Format:**
```
{FRONTEND_URL}/admin/approve-account/{approvalToken}
```

**Reject Button URL Format:**
```
{FRONTEND_URL}/admin/reject-account/{rejectionToken}
```

**Examples:**
```
https://osot.ca/admin/approve-account/approve_761f0e97ec80427e038deb1979a28
https://osot.ca/admin/reject-account/reject_761f0e97ec80427e038deb1979a28
```

**Parameters:**
- `approvalToken`: Token for approval action (in URL path)
- `rejectionToken`: Token for rejection action (in URL path)

**Backend Endpoints:**
- `POST /api/public/orchestrator/admin/approve/{approvalToken}` (no body)
- `POST /api/public/orchestrator/admin/reject/{rejectionToken}` (no body)

---

## 4. Admin Approval - Affiliate Organization

**Email Template:** Admin Approval Notification Email (Affiliate)

**Approve Button URL Format:**
```
{FRONTEND_URL}/admin/approve-affiliate/{approvalToken}
```

**Reject Button URL Format:**
```
{FRONTEND_URL}/admin/reject-affiliate/{rejectionToken}
```

**Examples:**
```
https://osot.ca/admin/approve-affiliate/approve_123abc456def789ghi
https://osot.ca/admin/reject-affiliate/reject_123abc456def789ghi
```

**Parameters:**
- `approvalToken`: Token for approval action (in URL path)
- `rejectionToken`: Token for rejection action (in URL path)

**Backend Endpoints:**
- `POST /api/public/affiliates/approve/{approvalToken}` (with body: action + reason)
- `POST /api/public/affiliates/approve/{rejectionToken}` (with body: action + reason)

**Note:** Affiliate approval/rejection requires admin to provide a reason via form on the page.

---

## Frontend Pages Summary

| Route | Purpose | Authentication Required |
|-------|---------|------------------------|
| `/verify-email` | Professional email verification | No |
| `/verify-affiliate-email` | Affiliate email verification | No |
| `/admin/approve-account/:approvalToken` | Admin approves professional | No (token-based) |
| `/admin/reject-account/:rejectionToken` | Admin rejects professional | No (token-based) |
| `/admin/approve-affiliate/:approvalToken` | Admin approves affiliate | No (token-based) |
| `/admin/reject-affiliate/:rejectionToken` | Admin rejects affiliate | No (token-based) |

---

## Frontend Features

**All pages include:**
- ✅ Loading state with spinner
- ✅ Success state with confirmation message
- ✅ Error state with specific error messages
- ✅ Automatic API calls on page load (verification/approval pages)
- ✅ Form validation (affiliate rejection requires min 10 characters)
- ✅ Navigation buttons (back to login/dashboard)
- ✅ Comprehensive error handling for all backend error codes

**Error Handling:**
- 400: Invalid verification token or data
- 404: Session not found or token expired
- 409: Invalid session state (already processed)
- 500: Internal server error

---

## Email Template Examples

### Professional Verification Email
```html
<p>Welcome to OSOT! Please verify your email address to continue your registration.</p>
<a href="https://osot.ca/verify-email?sessionId={{sessionId}}&token={{verificationToken}}" 
   style="background-color: #2563eb; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px;">
  Verify Email Address
</a>
<p>This link will expire in 24 hours.</p>
```

### Admin Approval Email (Professional)
```html
<p>A new professional user requires your approval.</p>
<p><strong>Email:</strong> {{userEmail}}</p>

<a href="https://osot.ca/admin/approve-account/{{approvalToken}}" 
   style="background-color: #16a34a; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; margin-right: 10px;">
  Approve Account
</a>

<a href="https://osot.ca/admin/reject-account/{{rejectionToken}}" 
   style="background-color: #dc2626; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px;">
  Reject Account
</a>

<p>This link will expire in 7 days.</p>
```

### Admin Approval Email (Affiliate)
```html
<p>A new affiliate organization requires your approval.</p>
<p><strong>Organization:</strong> {{organizationName}}</p>

<a href="https://osot.ca/admin/approve-affiliate/{{approvalToken}}" 
   style="background-color: #16a34a; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; margin-right: 10px;">
  Approve Organization
</a>

<a href="https://osot.ca/admin/reject-affiliate/{{rejectionToken}}" 
   style="background-color: #dc2626; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px;">
  Reject Organization
</a>

<p>Note: You will be asked to provide a reason for your decision.</p>
<p>This link will expire in 7 days.</p>
```

---

## Environment Configuration

**Development:**
```
FRONTEND_URL=http://localhost:5173
```

**Production:**
```
FRONTEND_URL=https://osot.ca
```

---

## Next Steps for Backend Team

1. ✅ Update email templates with button links using the formats above
2. ✅ Replace `{FRONTEND_URL}` with appropriate environment variable
3. ✅ Replace `{sessionId}`, `{verificationToken}`, `{approvalToken}`, `{rejectionToken}` with actual values
4. ✅ Set token expiration times (24h verification, 7 days approval)
5. ✅ Test email delivery with real tokens
6. ✅ Verify all endpoints return expected responses

---

**Document Version:** 1.0  
**Last Updated:** December 1, 2025  
**Frontend Implementation Status:** ✅ Complete
